<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Architecture - Fleet Credits Developer Documentation</title>
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="docs-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="logo-icon">üöÄ</span>
                    <span class="logo-text">Fleet Credits</span>
                </div>
                <div class="version">v1.0.0 - Core</div>
                <div class="tagline">Scrypt PoW Blockchain with Contribution Rewards & MWEB Privacy</div>
                <div class="subtagline">‚ú® Complete Developer Documentation</div>
            </div>

            <div class="search-box">
                <input type="text" placeholder="Search documentation..." id="searchInput">
            </div>

            <nav class="nav-menu">
                <div class="nav-section">
                    <div class="nav-section-title">GETTING STARTED</div>
                    <a href="../index.html" class="nav-item">
                        <span class="nav-icon">üè†</span>
                        <span>Overview</span>
                    </a>
                    <a href="architecture.html" class="nav-item">
                        <span class="nav-icon">üèõÔ∏è</span>
                        <span>Architecture</span>
                    </a>
                    <a href="network-params.html" class="nav-item">
                        <span class="nav-icon">‚öôÔ∏è</span>
                        <span>Network Parameters</span>
                    </a>
                    <a href="network-architecture.html" class="nav-item active">
                        <span class="nav-icon">üåê</span>
                        <span>Network Architecture</span>
                    </a>
                    <a href="building.html" class="nav-item">
                        <span class="nav-icon">üî®</span>
                        <span>Building & Setup</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">CORE BLOCKCHAIN</div>
                    <a href="blockchain-core.html" class="nav-item">
                        <span class="nav-icon">‚õìÔ∏è</span>
                        <span>Block & Transaction</span>
                    </a>
                    <a href="utxo-model.html" class="nav-item">
                        <span class="nav-icon">üíé</span>
                        <span>UTXO Model</span>
                    </a>
                    <a href="consensus.html" class="nav-item">
                        <span class="nav-icon">üîê</span>
                        <span>Consensus & PoW</span>
                    </a>
                    <a href="validation.html" class="nav-item">
                        <span class="nav-icon">‚úÖ</span>
                        <span>Validation System</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">CONTRIBUTION SYSTEM</div>
                    <a href="contribution-overview.html" class="nav-item">
                        <span class="nav-icon">üéØ</span>
                        <span>Contribution Overview</span>
                    </a>
                    <a href="contribution-types.html" class="nav-item">
                        <span class="nav-icon">üìã</span>
                        <span>Contribution Types</span>
                    </a>
                    <a href="contribution-rewards.html" class="nav-item">
                        <span class="nav-icon">üí∞</span>
                        <span>Reward System</span>
                    </a>
                    <a href="verification-system.html" class="nav-item">
                        <span class="nav-icon">üîç</span>
                        <span>Verification System</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">MWEB PRIVACY</div>
                    <a href="mweb-overview.html" class="nav-item">
                        <span class="nav-icon">üîí</span>
                        <span>MWEB Overview</span>
                    </a>
                    <a href="mweb-structures.html" class="nav-item">
                        <span class="nav-icon">üèóÔ∏è</span>
                        <span>MWEB Structures</span>
                    </a>
                    <a href="mweb-operations.html" class="nav-item">
                        <span class="nav-icon">‚ö°</span>
                        <span>Peg-in/Peg-out</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">RPC API</div>
                    <a href="rpc-overview.html" class="nav-item">
                        <span class="nav-icon">üì°</span>
                        <span>RPC Overview</span>
                    </a>
                    <a href="rpc-contribution.html" class="nav-item">
                        <span class="nav-icon">üì§</span>
                        <span>Contribution RPC</span>
                    </a>
                    <a href="rpc-mweb.html" class="nav-item">
                        <span class="nav-icon">üîê</span>
                        <span>MWEB RPC</span>
                    </a>
                    <a href="rpc-mining.html" class="nav-item">
                        <span class="nav-icon">‚õèÔ∏è</span>
                        <span>Mining RPC</span>
                    </a>
                    <a href="rpc-wallet.html" class="nav-item">
                        <span class="nav-icon">üëõ</span>
                        <span>Wallet RPC</span>
                    </a>
                    <a href="rpc-blockchain.html" class="nav-item">
                        <span class="nav-icon">‚õìÔ∏è</span>
                        <span>Blockchain RPC</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">WALLET SYSTEM</div>
                    <a href="wallet-overview.html" class="nav-item">
                        <span class="nav-icon">üëõ</span>
                        <span>Wallet Overview</span>
                    </a>
                    <a href="wallet-classes.html" class="nav-item">
                        <span class="nav-icon">üì¶</span>
                        <span>Wallet Classes</span>
                    </a>
                    <a href="address-system.html" class="nav-item">
                        <span class="nav-icon">üìç</span>
                        <span>Address System</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">QT GUI</div>
                    <a href="qt-overview.html" class="nav-item">
                        <span class="nav-icon">üñ•Ô∏è</span>
                        <span>GUI Overview</span>
                    </a>
                    <a href="qt-components.html" class="nav-item">
                        <span class="nav-icon">üß©</span>
                        <span>Components</span>
                    </a>
                    <a href="qt-models.html" class="nav-item">
                        <span class="nav-icon">üìä</span>
                        <span>Models</span>
                    </a>
                    <a href="qt-themes.html" class="nav-item">
                        <span class="nav-icon">üé®</span>
                        <span>Themes</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">FEE STRUCTURE</div>
                    <a href="fee-system.html" class="nav-item">
                        <span class="nav-icon">üíµ</span>
                        <span>Fee System</span>
                    </a>
                    <a href="community-reserve.html" class="nav-item">
                        <span class="nav-icon">üè¶</span>
                        <span>Community Reserve</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">TESTING</div>
                    <a href="testing-overview.html" class="nav-item">
                        <span class="nav-icon">üß™</span>
                        <span>Testing Overview</span>
                    </a>
                    <a href="test-structures.html" class="nav-item">
                        <span class="nav-icon">üìù</span>
                        <span>Test Structures</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">REFERENCE</div>
                    <a href="erd-diagram.html" class="nav-item">
                        <span class="nav-icon">üìê</span>
                        <span>ERD Diagram</span>
                    </a>
                    <a href="naming-conventions.html" class="nav-item">
                        <span class="nav-icon">üìù</span>
                        <span>Naming Conventions</span>
                    </a>
                    <a href="api-reference.html" class="nav-item">
                        <span class="nav-icon">üìö</span>
                        <span>Complete API Reference</span>
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="content-header">
                <h1>Network Architecture</h1>
                <p class="subtitle">Understanding Fleet Credits' peer-to-peer blockchain network</p>
            </div>

            <section class="content-section">
                <h2>How Blockchain Networks Work</h2>
                <p>Fleet Credits operates as a <strong>peer-to-peer (P2P) network</strong>, similar to BitTorrent or iMesh. There is no central server‚Äîthe blockchain runs on every node's computer.</p>

                <div class="info-box">
                    <strong>Key Concept:</strong> Each node runs a daemon (<code>fleetcreditsd</code>) that maintains a copy of the blockchain and connects to other nodes to share data.
                </div>

                <h3>Network Components</h3>
                <ul>
                    <li><strong>Nodes:</strong> Computers running Fleet Credits daemon</li>
                    <li><strong>Peers:</strong> Connected nodes that share blockchain data</li>
                    <li><strong>Blockchain:</strong> Distributed ledger stored on every node</li>
                    <li><strong>Mempool:</strong> Pending transactions waiting to be confirmed</li>
                    <li><strong>Mining:</strong> Process of creating new blocks</li>
                </ul>

                <h3>Network Discovery</h3>
                <p>Nodes discover each other through:</p>
                <ol>
                    <li><strong>DNS Seeds:</strong> Hardcoded IP addresses of initial nodes</li>
                    <li><strong>Peer Exchange:</strong> Existing peers share addresses of other peers</li>
                    <li><strong>Manual Connections:</strong> Using <code>-addnode</code> or <code>-connect</code> flags</li>
                </ol>
            </section>

            <section class="content-section">
                <h2>Network Isolation</h2>
                <p>Fleet Credits is <strong>completely isolated</strong> from Dogecoin and other networks through:</p>

                <h3>Magic Bytes (Message Start)</h3>
                <p>Unique 4-byte identifier that prevents connecting to wrong networks:</p>
                <pre><code>Mainnet:  0xFC 0x43 0x52 0x45  ("FCRE" for Fleet Credits)
Testnet:  0xFC 0x54 0x45 0x53  ("FTES" for Fleet Credits Testnet)
Regtest:  0xFA 0xBF 0xB5 0xDA  (Standard regtest)</code></pre>
                <p><strong>Location:</strong> <code>src/chainparams.cpp</code> - <code>pchMessageStart</code></p>

                <h3>Genesis Block</h3>
                <p>Each network has a unique genesis block hash that identifies the blockchain:</p>
                <ul>
                    <li><strong>Mainnet:</strong> Unique Fleet Credits genesis block</li>
                    <li><strong>Testnet:</strong> Different genesis block for testing</li>
                    <li><strong>Regtest:</strong> Local genesis block for development</li>
                </ul>
                <p><strong>Location:</strong> <code>src/chainparams.cpp</code> - <code>CreateGenesisBlock()</code></p>

                <h3>Port Numbers</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Network</th>
                            <th>P2P Port</th>
                            <th>RPC Port</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Mainnet</td>
                            <td>42069</td>
                            <td>42068</td>
                        </tr>
                        <tr>
                            <td>Testnet</td>
                            <td>44556</td>
                            <td>44555</td>
                        </tr>
                        <tr>
                            <td>Regtest</td>
                            <td>18444</td>
                            <td>18332</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Seed Nodes</h3>
                <p><strong>Current Status:</strong> Fleet Credits ships with a single fixed seed for bootstrap.</p>
                <ul>
                    <li><strong>Mainnet Seed:</strong> <code>96.126.123.195:42069</code> (stored in <code>vFixedSeeds</code>)</li>
                    <li>Old Dogecoin seeds have been removed to prevent cross-network traffic</li>
                    <li>Additional public nodes can be compiled into <code>chainparamsseeds.h</code> as the network grows</li>
                    <li>For private testing, continue to use <code>-addnode</code> / <code>-connect</code></li>
                </ul>
                <p><strong>Location:</strong> <code>src/chainparams.cpp</code> - <code>vFixedSeeds.push_back(...)</code></p>
            </section>

            <section class="content-section">
                <h2>Network Modes</h2>

                <h3>Mainnet (Production)</h3>
                <ul>
                    <li><strong>Purpose:</strong> Live production network</li>
                    <li><strong>Isolation:</strong> Via magic bytes + genesis block</li>
                    <li><strong>Peer Discovery:</strong> DNS seeds + P2P (when deployed)</li>
                    <li><strong>Usage:</strong> Real transactions, real value</li>
                </ul>

                <h3>Testnet (Testing)</h3>
                <ul>
                    <li><strong>Purpose:</strong> Testing economic policies and features</li>
                    <li><strong>Isolation:</strong> Via magic bytes + genesis block</li>
                    <li><strong>Peer Discovery:</strong> DNS seeds + P2P (when deployed)</li>
                    <li><strong>Usage:</strong> Testing without real value</li>
                </ul>

                <h3>Regtest (Development)</h3>
                <ul>
                    <li><strong>Purpose:</strong> Local development and testing</li>
                    <li><strong>Isolation:</strong> Complete isolation (no network connections)</li>
                    <li><strong>Peer Discovery:</strong> None (local only)</li>
                    <li><strong>Usage:</strong> Fast development, instant block generation</li>
                </ul>
            </section>

            <section class="content-section">
                <h2>Starting the Network</h2>

                <h3>Regtest Mode (Recommended for Development)</h3>
                <p>Completely isolated, no network needed. <strong>Important:</strong> Regtest requires the <code>-mocktime=1776643200</code> flag because the genesis block timestamp is in the future (April 20, 2026).</p>
                <pre><code># Start daemon in regtest mode
./fleetcreditsd -regtest -mocktime=1776643200 -daemon

# Generate blocks locally
./fleetcredits-cli -regtest generate 100

# Check balance
./fleetcredits-cli -regtest getbalance

# Verify genesis block
./fleetcredits-cli -regtest getblockhash 0
# Should return: 556f8207d42c427a03d882d2e338a0102342648ce203f82a11efbe596da0f55e</code></pre>
                
                <div class="warning-box">
                    <strong>Genesis Block Mismatch:</strong> If you see a "genesis block mismatch" error, clear old regtest data:
                    <pre><code>rm -rf ~/.fleetcredits/regtest/blocks
rm -rf ~/.fleetcredits/regtest/chainstate
rm -f ~/.fleetcredits/regtest/peers.dat</code></pre>
                    Then restart with <code>-regtest -mocktime=1776643200</code>.
                </div>

                <h3>Private Testnet</h3>
                <p>Connect multiple nodes manually:</p>
                <pre><code># Node 1 (First node)
./fleetcreditsd -testnet -daemon -listen -port=44556

# Node 2 (Connect to node 1)
./fleetcreditsd -testnet -daemon -addnode=192.168.1.100:44556

# Node 3 (Connect to either)
./fleetcreditsd -testnet -daemon -addnode=192.168.1.100:44556 -addnode=192.168.1.101:44556</code></pre>

                <h3>Public Mainnet</h3>
                <p>Current bootstrap relies on the hardcoded seed:</p>
                <pre><code># Start node - connects to 96.126.123.195:42069 automatically
./fleetcreditsd -daemon

# Force connection if necessary
./fleetcreditsd -daemon -connect=96.126.123.195:42069

# Check peer connections
./fleetcredits-cli getpeerinfo</code></pre>
            </section>

            <section class="content-section">
                <h2>Network Protocol</h2>
                <p>The network follows a standard blockchain protocol:</p>

                <ol>
                    <li><strong>Node Startup:</strong> Connect to seed nodes or manual peers</li>
                    <li><strong>Version Exchange:</strong> Exchange version messages with magic bytes</li>
                    <li><strong>Blockchain Sync:</strong> Request and download blocks from peers</li>
                    <li><strong>Transaction Broadcast:</strong> Broadcast new transactions to peers</li>
                    <li><strong>Block Propagation:</strong> Share new blocks with connected peers</li>
                    <li><strong>Peer Exchange:</strong> Share known peer addresses</li>
                </ol>

                <div class="info-box">
                    <strong>Handshake accuracy:</strong> Fleet Credits calls <code>connman.SetBestHeight()</code> immediately after block index load/rewind (see <code>src/init.cpp</code>). This ensures the <code>startingheight</code> field advertised in the <code>version</code> message reflects the node's actual chain tip, preventing premature bans during initial sync.
                </div>

                <h3>Message Types</h3>
                <ul>
                    <li><code>version</code> - Initial handshake</li>
                    <li><code>verack</code> - Version acknowledgment</li>
                    <li><code>addr</code> - Peer address sharing</li>
                    <li><code>inv</code> - Inventory (block/transaction announcements)</li>
                    <li><code>getdata</code> - Request specific blocks/transactions</li>
                    <li><code>block</code> - Block data</li>
                    <li><code>tx</code> - Transaction data</li>
                    <li><code>ping</code> / <code>pong</code> - Keep-alive</li>
                </ul>
            </section>

            <section class="content-section">
                <h2>Blockchain Data Storage</h2>
                <p>Each node stores blockchain data locally:</p>

                <pre><code>~/.fleetcredits/
‚îú‚îÄ‚îÄ blocks/
‚îÇ   ‚îú‚îÄ‚îÄ blk00000.dat  (Block data)
‚îÇ   ‚îú‚îÄ‚îÄ blk00001.dat
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ chainstate/       (UTXO database)
‚îú‚îÄ‚îÄ wallet.dat        (Your wallet)
‚îî‚îÄ‚îÄ fleetcredits.conf (Config file)</code></pre>

                <div class="warning-box">
                    <strong>Important:</strong> Each node maintains its own complete copy of the blockchain. There is no central database!
                </div>
            </section>

            <section class="content-section">
                <h2>Why "Connecting to Peers" Takes Time</h2>
                <p>When you see "Connecting to peers...", it means:</p>

                <ul>
                    <li><strong>No peers found:</strong> Network is new, no seed nodes yet</li>
                    <li><strong>Firewall blocking:</strong> Port 42069 not open</li>
                    <li><strong>Wrong network:</strong> Trying to connect to wrong network (fixed now!)</li>
                    <li><strong>Regtest mode:</strong> No network connections (by design)</li>
                </ul>

                <h3>Solutions</h3>
                <ul>
                    <li><strong>For development:</strong> Use <code>-regtest</code> mode (no network needed)</li>
                    <li><strong>For testing:</strong> Manually connect nodes with <code>-addnode</code></li>
                    <li><strong>For production:</strong> Deploy seed nodes first</li>
                </ul>
            </section>

            <section class="content-section">
                <h2>Key Takeaways</h2>
                <div class="checklist">
                    <div class="check-item">‚úÖ Blockchain = Peer-to-peer network (like BitTorrent)</div>
                    <div class="check-item">‚úÖ Each node runs a daemon (fleetcreditsd)</div>
                    <div class="check-item">‚úÖ No central server - fully decentralized</div>
                    <div class="check-item">‚úÖ Network isolation via magic bytes + genesis block</div>
                    <div class="check-item">‚úÖ For development - use -regtest (isolated, fast)</div>
                    <div class="check-item">‚úÖ For testing - use -testnet with manual connections</div>
                    <div class="check-item">‚úÖ For production - deploy seed nodes first</div>
                </div>
            </section>

            <section class="content-section">
                <h2>Related Documentation</h2>
                <ul>
                    <li><a href="network-params.html">Network Parameters</a> - Detailed chain parameters</li>
                    <li><a href="consensus.html">Consensus & PoW</a> - Proof-of-Work mechanism</li>
                    <li><a href="validation.html">Validation System</a> - Block and transaction validation</li>
                    <li><a href="blockchain-core.html">Block & Transaction</a> - Core blockchain structures</li>
                </ul>
            </section>
        </main>
    </div>

    <script src="../assets/js/main.js"></script>
</body>
</html>

